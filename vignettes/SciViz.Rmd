---
title: "SciViz"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{SciViz}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

This package was designed for scientists to create beautiful and publishable graphs without needing to learn the ins and outs of coding graphs in R. While these functions were created with astronomy, neuroscience, and psychology in mind, they can be used in any fields. 

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, warning = F, message = F}
library(SciViz)
```

## APA Graphs 

### Line 

### Bar 

## Network Plots and Heatmaps 

### Network Plot 

### Heatmap 

Heatmaps use color to graphically represent relationships between many variables or observations. They originated in the 19th century, where scientists would manually draw each "pixel" in grayscale. 

<img src="og_grayscale_heatmap.jpg" alt="Manually drawn heatmap from 1873 Paris." width="200"/>

Correlation heatmaps are used in neuroscience to illustrate connectivity between brain regions. This is often done by taking electroencephalography data of the brain and consequently plotting time on both axes, with color demonstrating relative correlation values. This is shown in the example below. 

<img src="neuro_heatmap_example.heic" alt="Heatmap of brain regions with time on both axes." width="200"/>

This image shows an example of a heatmap of brain regions with time on both axes. It shows the difference in connectivity when on ketamine, midazolam, before falling asleep, and sleeping all compared to controls. The red line along the diagonal demonstrates how each time point is 100% correlated to itself. Electroencephalography data taken in monkeys by [Professor Teichert's Lab](https://www.teichert.pitt.edu/index.html) at Pittsburgh University. 

Unfortunately, the datasets used to make plots like this in real research labs is classified due to regulations about data privacy. So we will use [mtcars](https://www.statology.org/mtcars-dataset-r/) to demonstrate the use of this package's `corrheatmap` function. 

This `corrheatmap` function uses the packages [corrplots](https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html) and [gplots](https://www.rdocumentation.org/packages/gplots/versions/3.2.0) to create a correlation heatmap for as many numeric variables and observations as the user desires. If using a large dataset, the `n_colors` argument should be increased accordingly. 

First, the function creates the correlation values to plot. 
```{r, warning = F, message = F}
data(mtcars)
cor(mtcars)
```

Then, it creates a color palatte from the colors given in the `colors` argument.
```{r, warning = F, message = F}
library(grDevices)
colorRampPalette(c("#00ffff", "#ff00ff", "#ffff00")) (20)
```

Finally, it creates the graph in a new Quartz window. 
```{r, warning = F, message = F}
library(corrplot)
library(gplots)
#library(grDevices)

dev.new()

#create correlation values
c <- cor(mtcars)

#create color palette based on user input or default
color <- colorRampPalette(c("#00ffff", "#ff00ff", "#ffff00")) (20)

#create graph in new window
heatmap.2(c,
          col = color,
          na.rm = TRUE,
          dendrogram = "both",
          key = TRUE,
          symm = TRUE,
          margins = c(10, 10),  #Adjust margins to fit labels
          cexRow = 1,           #Adjust row label size
          cexCol = 1,           #Adjust column label size
          las = 3,              #Angles column labels
          trace = "none",       #Turn off tracing lines
          main = "mtcars Correlation Heatmap")         #Add the title

```

You can specify if you want dendrograms on both the rows and the columns, just the columns, just the rows, or no dendrogram.
```{r, warning = F, message = F}
corrheatmap(mtcars, title="Correlations of Car Features", dend="both")
```

```{r, warning = F, message = F}
corrheatmap(mtcars, title="Correlations of Car Features", dend="row")
```

```{r, warning = F, message = F}
corrheatmap(mtcars, title="Correlations of Car Features", dend="col")
```

```{r, warning = F, message = F}
corrheatmap(mtcars, title="Correlations of Car Features", dend="none")
```

Only one argument is needed, `data`, a matrix or a data frame. The data must be numeric, with all categorical variables dummy coded, in order for correlation values to be calculated. 

Optional arguments are `colors`, `n_colors`, `title`, and `dend` for addition of a dendrogram to rows, columns, or both.
`colors`: A vector of 3 colors. Defualt is magenta (#ff00ff), cyan (#00ffff), and yellow (#ffff00). The color argument uses the package [grDevices](https://www.rdocumentation.org/packages/grDevices/versions/3.6.2) [colorRampPallete](https://www.rdocumentation.org/packages/grDevices/versions/3.6.2/topics/colorRamp) function, and thus can take a vector of colors in agreement with the valid argumnents of [col2rgb](https://www.rdocumentation.org/packages/grDevices/versions/3.6.2/topics/col2rgb). Colors can be  hexadecimal form, color name (as listed by [colors()](), or a positive integer i, meaning palatte()[i].
`n_colors`: number of colors to be created in pallate from `colors` argument. Default is 20. Increase for large datasets. 
`title`: A string of characters. Default is "Correlation Heatmap".
`dend`: A string; "row", "column", "both", or "none". Default is "both".

The `corrheatmap` function returns a correlation heatmap in a new Quartz window with a heatmap, title, color key and histogram, axis labels, and optional dendrograms. 

#### Notes and Considerations
*Even with a relatively small dataset such as `mtcars`, when the `dend` argument is specified as "both", the window needed to print the plot is too large for RStudio. The function is set to open a new Quartz window when the function is run, so do not be surprised when nothing pops up in the Plots window in RStudio. The plot will appear in a separate window. This is done using the [grDevices](https://www.rdocumentation.org/packages/grDevices/versions/3.6.2) package's [dev.new](https://www.rdocumentation.org/packages/grDevices/versions/3.6.2/topics/dev) function. 
*If you have already run the function and run it a second time, sometimes the window is updated to the new graph, but is not brought to the front of your screen. If this happens, look for a hidden window behind your other windows. 


## Cornerplots and Scatterplots

### Cornerplots 

Cornerplots are often used in astronomy to understand the distribution of numeric variables. These are often used to display the results from Markov Chain Monte Carlo (MCMC) simulations, and are used by astronomers to identify if their variables have Gaussian distributions. While those methods are likely familiar to astronomers who may be using this package, even if you aren't sure what an MCMC simulation of a Gaussian distribution is, there are other ways to utilize this package for a better understanding of your data. 

Let's look at an example with the dataset from this package, [starcatalog](). This dataset has information on 8774 stars, and we might be interested in seeing the relationships between the numeric variables in this dataset. Here is how you can make a cornerplot, using all of the default settings. You only need to specify a dataset, and the function will create the requested graph.  

```{r, warning = F, message = F}
cornerplot(starcatalog)
```

This plotted all of the numeric variables in the dataset, `bv_color`, `parallax`, and `vmag` against each other in both 2d and 1d histograms. The 1d histograms are shown in purple and show only the distribution of the variable on the x-axis, while the 2d histograms show paired distributions for the variables on the x- and y-axes. Here, we can see that parallax is very right-skewed, which is also clear through the 2d histograms it is a part of, clumping the data vertically downwards. We can see that there are possibly some outliers in this data when looking at the combinations of `bv_color` and `parallax`, as there are a few data points with abnormally high parallax, even though they have values in the normal range for `bv_color`. Additionally, we can see how many points fall within each range by using the colorbar next to the 2d histograms. For example, when examining just `bv_color` and `vmag`, there is a high concentration of stars that have a `vmag` value of around six, with a `bv_color` value of around zero. 

There are many ways you can customize these plots to make them better suit your needs. For example, if you only want to examine the relationships between two of the variables in starcatalog, you can specify them. You can also remove the countor plot that sits on top of the cornerplot, and change the color of both kinds of histograms. Any [`ggplot2` color](https://sape.inf.usi.ch/quick-reference/ggplot2/colour) can be used to change the color of the histograms, and color palette options have been taken from the [colorspace](https://colorspace.r-forge.r-project.org/articles/ggplot2_color_scales.html#available-palettes) package. 

```{r}
cornerplot(starcatalog, varlist = c("vmag", "bv_color"), palette = "Blues", fill="dodgerblue3", contour = FALSE)
```

Here, we have changed the graph so that both histograms have a blue fill/palette, only two of the variables are displayed, and the contour has been removed. 

Further customization can be achieved through changing the number of bins and contour lines. The default number of bins for the histograms is 30, but can be adjusted down to any number of your choosing. Similarly, the default number of contours is 3. The `bins` parameter adjusts the number of bins in both the 1d and 2d histograms, while the `contourBins` parameter is only used when there is a contour plot on top of the 2d histograms.

```{r}
cornerplot(starcatalog, bins = 50, contourBins = 5)
```

In the example above, it is harder to see the distributions because there are so many bins, so be sure to change the `bins` and `contourBins` parameters until you get a result you are happy with. 

### Scatterplots 

The scatterplots included in this package have been optimized to work with large datasets, and can be customized to fit your preferences. These plots can be used to look at any two numeric variables and the relationship between them. You must specify the dataset, an x-variable, and a y-variable. 

```{r, warning = F, message = F}
scatterplot(starcatalog, x = "vmag", y = "bv_color")
```

In this example, we can see where there are large concentrations of each variable, and the relationship between the two variables. To investigate the variables in the dataset further, you can use a grouping or color variable to identify how this relationship is changed by addding a categorical variable into the mix. 

```{r}
scatterplot(starcatalog, "vmag", "bv_color", color = "multiple", palette = "Viridis")
```

Sometimes it can be hard to make out the different colors on this graph, so you can also facet the variable instead of changing the color of the points. Here is an example using the same variable as the graph above. 

```{r}
scatterplot(starcatalog, "vmag", "bv_color", group = "multiple", color = "multiple", palette = "Viridis")
```

Now we can see that it was hard to see the multiples of A, R, and I because there were very few stars with these multiples! You do not have to specify both group and color and the points will default to black if no color is specified. 

Other customizable features of this graph include changing the `alpha` or the opacity of the points, and the `size` of these points. Both the `size` and the `alpha` default to 0.5. Here is an example of how changing these parameters changes the graph, using the graph that we've been creating. The `color` parameter has been changed to blue4, to make the points easier to see against the white background. 

```{r}
scatterplot(starcatalog, "vmag", "bv_color", group = "multiple", color = "blue4", palette = "Viridis", size = 0.2, alpha = 0.8)
```

Here, the points are smaller but also less opaque, which makes each individual point easier to see. Each of these parameters can be customized to your liking, until you have a graph that adequately displays all of the information you want to capture. 
